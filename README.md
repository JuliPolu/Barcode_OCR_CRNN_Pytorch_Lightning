# Barcode OCR

## Основная задача

Создание модели распознавания цифр на штрих-кодах (OCR) по фотографиям.

Данный репозиторий подготовлен в рамках 2-й проектной работы курса 'CV-Rocket' от команды Deepschool, часть по созданию и тренировке модели OCR.


### Датасет

Трейн датасет включает 540 фото, предварительно собранных с помощью Tолоки.

[Ссылка](https://disk.yandex.ru/d/pRFNuxLQUZcDDg) на исходный датасет

Запускаем скрипт чтобы вырезать кропы баркодов чтобы ускорить обучение
crop_barcodes.py

Перед тем как запускать обучение, необходимо:
- запустить [скрипт](crop_barcodes.py), чтобы вырезать кропы баркодов для ускорения обучение 
- входной размер изображения и бекбон для CRNN. Для этого используется [эта](notebooks/подбор параметров.ipynb) тетрадка.


## Используемый стэк

Python, Pytorch, albumentations, Pytorch Lightning, onnxruntime, pydantic, wemake


### Обучение

Запуск тренировки:

```bash
make run_training
```

### Логи финальной модели в ClearML

Перформанс модели можно посмотреть тут:

[ClearML](https://app.clear.ml/projects/d0622774127546c4820e6fc78dbfd129/experiments/1feb80cd1cd34cc6aa8f8c60f26f1fca/output/execution)


### Актуальная версия чекпойнта модели:

```bash
make dvc_checkpoint
```

### Актуальная версия сохраненной torscript модели:

```bash
make dvc_pull
```


### Инеренс

Посмотреть результаты работы обученной сети можно посмотреть в [тетрадке](notebooks/анализ результатов.ipynb)

А также запустить скрипт для конвертации чекпойнта в onnx


```bash
make convert_checkpoint
```

И запустить скрипт для инференса

```bash
make inference
```

### Комментарии и история экспериментов 

Кратко подбор параметров в файле [HISTORY&COMMENTS.md](HISTORY&COMMENTS.md)
